<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Dashboard - Standalone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="mb-8 flex justify-between items-start">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Marketing Dashboard</h1>
                    <p class="text-gray-600">Upload your Excel data as CSV or edit manually</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="downloadTemplate()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium">
                        üì• Download Excel Template
                    </button>
                    <label class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium cursor-pointer">
                        üì§ Upload CSV Data
                        <input type="file" accept=".csv" onchange="handleFileUpload(event)" class="hidden">
                    </label>
                </div>
            </div>

            <!-- Upload Instructions -->
            <div class="mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
                <h3 class="font-semibold text-blue-900 mb-2">üìã How to Use:</h3>
                <ol class="text-blue-800 text-sm space-y-1 list-decimal list-inside">
                    <li>Click "Download Excel Template" to get the data template</li>
                    <li>Fill in your data in Excel</li>
                    <li>Save each sheet as CSV (File ‚Üí Save As ‚Üí CSV)</li>
                    <li>Upload the CSV files using "Upload CSV Data" button</li>
                    <li>Dashboard will update automatically!</li>
                </ol>
            </div>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow p-6 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-600 text-sm font-medium">Total Visitors</span>
                        <span class="text-2xl">üë•</span>
                    </div>
                    <div class="text-3xl font-bold text-gray-900 mb-2" id="kpi-visitors">24.5K</div>
                    <div class="flex items-center text-sm">
                        <span class="text-green-600" id="kpi-visitors-change">+12.5%</span>
                        <span class="text-gray-500 ml-1">vs last period</span>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-600 text-sm font-medium">Conversion Rate</span>
                        <span class="text-2xl">üéØ</span>
                    </div>
                    <div class="text-3xl font-bold text-gray-900 mb-2" id="kpi-conversion">3.24%</div>
                    <div class="flex items-center text-sm">
                        <span class="text-green-600" id="kpi-conversion-change">+0.8%</span>
                        <span class="text-gray-500 ml-1">vs last period</span>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-600 text-sm font-medium">Revenue</span>
                        <span class="text-2xl">üí∞</span>
                    </div>
                    <div class="text-3xl font-bold text-gray-900 mb-2" id="kpi-revenue">$48,392</div>
                    <div class="flex items-center text-sm">
                        <span class="text-green-600" id="kpi-revenue-change">+18.2%</span>
                        <span class="text-gray-500 ml-1">vs last period</span>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-600 text-sm font-medium">Page Views</span>
                        <span class="text-2xl">üëÅÔ∏è</span>
                    </div>
                    <div class="text-3xl font-bold text-gray-900 mb-2" id="kpi-pageviews">125.8K</div>
                    <div class="flex items-center text-sm">
                        <span class="text-red-600" id="kpi-pageviews-change">-2.4%</span>
                        <span class="text-gray-500 ml-1">vs last period</span>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Traffic Chart -->
                <div class="bg-white rounded-lg shadow p-6 border border-gray-200">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Traffic & Conversions</h2>
                    <canvas id="trafficChart"></canvas>
                </div>

                <!-- Traffic Sources Chart -->
                <div class="bg-white rounded-lg shadow p-6 border border-gray-200">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Traffic Sources</h2>
                    <canvas id="sourceChart"></canvas>
                </div>
            </div>

            <!-- Campaign Performance -->
            <div class="bg-white rounded-lg shadow p-6 border border-gray-200 mb-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Campaign Performance</h2>
                <canvas id="campaignChart"></canvas>
            </div>

            <!-- ROI Table -->
            <div class="bg-white rounded-lg shadow border border-gray-200 overflow-hidden">
                <div class="p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Campaign ROI</h2>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full" id="roiTable">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Campaign</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Spend</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Revenue</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ROI</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="roiTableBody">
                            <tr>
                                <td class="px-6 py-4 text-sm font-medium text-gray-900">Summer Sale</td>
                                <td class="px-6 py-4 text-sm text-gray-500">$5,200</td>
                                <td class="px-6 py-4 text-sm text-gray-500">$18,400</td>
                                <td class="px-6 py-4 text-sm font-semibold text-green-600">254%</td>
                                <td class="px-6 py-4"><span class="px-2 inline-flex text-xs font-semibold rounded-full bg-green-100 text-green-800">Active</span></td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 text-sm font-medium text-gray-900">Product Launch</td>
                                <td class="px-6 py-4 text-sm text-gray-500">$8,900</td>
                                <td class="px-6 py-4 text-sm text-gray-500">$25,600</td>
                                <td class="px-6 py-4 text-sm font-semibold text-green-600">188%</td>
                                <td class="px-6 py-4"><span class="px-2 inline-flex text-xs font-semibold rounded-full bg-green-100 text-green-800">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- How to Use Section -->
            <div class="mt-8 bg-white rounded-lg shadow border border-gray-200 p-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">üìö How to Use This Dashboard</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Step 1 -->
                    <div class="bg-blue-50 rounded-lg p-6 border border-blue-200">
                        <div class="flex items-start gap-3">
                            <div class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">1</div>
                            <div>
                                <h3 class="font-semibold text-gray-900 mb-2">Download the Template</h3>
                                <p class="text-sm text-gray-700">Click the "Download Excel Template" button at the top. This gives you a text file with all data formats and column headers you need.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2 -->
                    <div class="bg-green-50 rounded-lg p-6 border border-green-200">
                        <div class="flex items-start gap-3">
                            <div class="bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">2</div>
                            <div>
                                <h3 class="font-semibold text-gray-900 mb-2">Prepare Your Excel Data</h3>
                                <p class="text-sm text-gray-700">Copy each section into separate Excel sheets. Fill in your marketing data. Keep the column headers exactly as shown in the template.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3 -->
                    <div class="bg-purple-50 rounded-lg p-6 border border-purple-200">
                        <div class="flex items-start gap-3">
                            <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">3</div>
                            <div>
                                <h3 class="font-semibold text-gray-900 mb-2">Save as CSV Files</h3>
                                <p class="text-sm text-gray-700">In Excel, save each sheet as CSV (File ‚Üí Save As ‚Üí CSV). Name them: traffic.csv, sources.csv, campaigns.csv, roi.csv</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4 -->
                    <div class="bg-orange-50 rounded-lg p-6 border border-orange-200">
                        <div class="flex items-start gap-3">
                            <div class="bg-orange-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">4</div>
                            <div>
                                <h3 class="font-semibold text-gray-900 mb-2">Upload & View Dashboard</h3>
                                <p class="text-sm text-gray-700">Click "Upload CSV Data" and select your CSV files. The dashboard will automatically update with your data and show all visualizations!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Format Guide -->
                <div class="mt-8 border-t pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üìä Data Format Guide</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-gray-50 rounded p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">Traffic Data (traffic.csv)</h4>
                            <code class="text-xs text-gray-700 block">date, visitors, conversions</code>
                            <p class="text-xs text-gray-600 mt-2">Daily website traffic and conversion numbers</p>
                        </div>
                        
                        <div class="bg-gray-50 rounded p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">Traffic Sources (sources.csv)</h4>
                            <code class="text-xs text-gray-700 block">name, value</code>
                            <p class="text-xs text-gray-600 mt-2">Channel names and their percentage values</p>
                        </div>
                        
                        <div class="bg-gray-50 rounded p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">Campaign Data (campaigns.csv)</h4>
                            <code class="text-xs text-gray-700 block">campaign, impressions, clicks, conversions</code>
                            <p class="text-xs text-gray-600 mt-2">Campaign performance metrics</p>
                        </div>
                        
                        <div class="bg-gray-50 rounded p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">ROI Data (roi.csv)</h4>
                            <code class="text-xs text-gray-700 block">campaign, spend, revenue, status</code>
                            <p class="text-xs text-gray-600 mt-2">Campaign spending and return on investment</p>
                        </div>
                    </div>
                </div>

                <!-- Tips & Tricks -->
                <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-900 mb-2">üí° Pro Tips:</h4>
                    <ul class="text-sm text-gray-700 space-y-1 list-disc list-inside">
                        <li>Save this HTML file to your computer for offline use</li>
                        <li>Keep your CSV files in a folder for easy access</li>
                        <li>Update your Excel data anytime and re-upload to see changes</li>
                        <li>Column headers must match exactly (case-sensitive)</li>
                        <li>The dashboard works completely offline - no internet needed!</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize data
        let dashboardData = {
            traffic: [
                { date: 'Mon', visitors: 2400, conversions: 240 },
                { date: 'Tue', visitors: 1398, conversions: 180 },
                { date: 'Wed', visitors: 9800, conversions: 520 },
                { date: 'Thu', visitors: 3908, conversions: 390 },
                { date: 'Fri', visitors: 4800, conversions: 450 },
                { date: 'Sat', visitors: 3800, conversions: 340 },
                { date: 'Sun', visitors: 4300, conversions: 410 }
            ],
            sources: [
                { name: 'Organic Search', value: 35 },
                { name: 'Paid Ads', value: 25 },
                { name: 'Social Media', value: 20 },
                { name: 'Email', value: 15 },
                { name: 'Direct', value: 5 }
            ],
            campaigns: [
                { campaign: 'Summer Sale', impressions: 45000, clicks: 3200, conversions: 280 },
                { campaign: 'Product Launch', impressions: 38000, clicks: 2900, conversions: 320 },
                { campaign: 'Newsletter', impressions: 22000, clicks: 1800, conversions: 180 },
                { campaign: 'Retargeting', impressions: 15000, clicks: 1200, conversions: 150 }
            ]
        };

        let charts = {};

        // Initialize Charts
        function initCharts() {
            // Traffic Chart
            const trafficCtx = document.getElementById('trafficChart').getContext('2d');
            charts.traffic = new Chart(trafficCtx, {
                type: 'line',
                data: {
                    labels: dashboardData.traffic.map(d => d.date),
                    datasets: [{
                        label: 'Visitors',
                        data: dashboardData.traffic.map(d => d.visitors),
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Conversions',
                        data: dashboardData.traffic.map(d => d.conversions),
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: true } }
                }
            });

            // Source Chart
            const sourceCtx = document.getElementById('sourceChart').getContext('2d');
            charts.source = new Chart(sourceCtx, {
                type: 'doughnut',
                data: {
                    labels: dashboardData.sources.map(d => d.name),
                    datasets: [{
                        data: dashboardData.sources.map(d => d.value),
                        backgroundColor: ['#3b82f6', '#8b5cf6', '#ec4899', '#10b981', '#f59e0b']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            // Campaign Chart
            const campaignCtx = document.getElementById('campaignChart').getContext('2d');
            charts.campaign = new Chart(campaignCtx, {
                type: 'bar',
                data: {
                    labels: dashboardData.campaigns.map(d => d.campaign),
                    datasets: [{
                        label: 'Impressions',
                        data: dashboardData.campaigns.map(d => d.impressions),
                        backgroundColor: '#3b82f6'
                    }, {
                        label: 'Clicks',
                        data: dashboardData.campaigns.map(d => d.clicks),
                        backgroundColor: '#8b5cf6'
                    }, {
                        label: 'Conversions',
                        data: dashboardData.campaigns.map(d => d.conversions),
                        backgroundColor: '#10b981'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: true } }
                }
            });
        }

        // Handle CSV Upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            Papa.parse(file, {
                header: true,
                complete: function(results) {
                    updateDashboardFromCSV(results.data, file.name);
                    alert('‚úÖ Data uploaded successfully!');
                },
                error: function(error) {
                    alert('‚ùå Error reading file: ' + error.message);
                }
            });
        }

        // Update dashboard from CSV
        function updateDashboardFromCSV(data, filename) {
            const lower = filename.toLowerCase();
            
            if (lower.includes('traffic') || lower.includes('daily')) {
                dashboardData.traffic = data.filter(row => row.date && row.visitors).map(row => ({
                    date: row.date || row.Date || row.day || row.Day,
                    visitors: parseInt(row.visitors || row.Visitors || 0),
                    conversions: parseInt(row.conversions || row.Conversions || 0)
                }));
                updateTrafficChart();
            }
            else if (lower.includes('source') || lower.includes('channel')) {
                dashboardData.sources = data.filter(row => row.name && row.value).map(row => ({
                    name: row.name || row.Name || row.source || row.Source,
                    value: parseInt(row.value || row.Value || row.percentage || row.Percentage || 0)
                }));
                updateSourceChart();
            }
            else if (lower.includes('campaign')) {
                dashboardData.campaigns = data.filter(row => row.campaign).map(row => ({
                    campaign: row.campaign || row.Campaign,
                    impressions: parseInt(row.impressions || row.Impressions || 0),
                    clicks: parseInt(row.clicks || row.Clicks || 0),
                    conversions: parseInt(row.conversions || row.Conversions || 0)
                }));
                updateCampaignChart();
            }
            else if (lower.includes('roi') || lower.includes('spend')) {
                updateROITable(data);
            }
        }

        // Update charts
        function updateTrafficChart() {
            charts.traffic.data.labels = dashboardData.traffic.map(d => d.date);
            charts.traffic.data.datasets[0].data = dashboardData.traffic.map(d => d.visitors);
            charts.traffic.data.datasets[1].data = dashboardData.traffic.map(d => d.conversions);
            charts.traffic.update();
        }

        function updateSourceChart() {
            charts.source.data.labels = dashboardData.sources.map(d => d.name);
            charts.source.data.datasets[0].data = dashboardData.sources.map(d => d.value);
            charts.source.update();
        }

        function updateCampaignChart() {
            charts.campaign.data.labels = dashboardData.campaigns.map(d => d.campaign);
            charts.campaign.data.datasets[0].data = dashboardData.campaigns.map(d => d.impressions);
            charts.campaign.data.datasets[1].data = dashboardData.campaigns.map(d => d.clicks);
            charts.campaign.data.datasets[2].data = dashboardData.campaigns.map(d => d.conversions);
            charts.campaign.update();
        }

        function updateROITable(data) {
            const tbody = document.getElementById('roiTableBody');
            tbody.innerHTML = data.filter(row => row.campaign).map(row => {
                const spend = parseFloat(row.spend || row.Spend || 0);
                const revenue = parseFloat(row.revenue || row.Revenue || 0);
                const roi = spend > 0 ? Math.round(((revenue - spend) / spend) * 100) : 0;
                const status = row.status || row.Status || 'Active';
                
                return `
                    <tr>
                        <td class="px-6 py-4 text-sm font-medium text-gray-900">${row.campaign || row.Campaign}</td>
                        <td class="px-6 py-4 text-sm text-gray-500">$${spend.toLocaleString()}</td>
                        <td class="px-6 py-4 text-sm text-gray-500">$${revenue.toLocaleString()}</td>
                        <td class="px-6 py-4 text-sm font-semibold text-green-600">${roi}%</td>
                        <td class="px-6 py-4">
                            <span class="px-2 inline-flex text-xs font-semibold rounded-full ${
                                status === 'Active' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'
                            }">${status}</span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Download Excel Template
        function downloadTemplate() {
            const templates = {
                traffic: 'date,visitors,conversions\nMon,2400,240\nTue,1398,180\nWed,9800,520\nThu,3908,390\nFri,4800,450\nSat,3800,340\nSun,4300,410',
                sources: 'name,value\nOrganic Search,35\nPaid Ads,25\nSocial Media,20\nEmail,15\nDirect,5',
                campaigns: 'campaign,impressions,clicks,conversions\nSummer Sale,45000,3200,280\nProduct Launch,38000,2900,320\nNewsletter,22000,1800,180\nRetargeting,15000,1200,150',
                roi: 'campaign,spend,revenue,status\nSummer Sale,5200,18400,Active\nProduct Launch,8900,25600,Active\nNewsletter,1200,4320,Active\nRetargeting,3400,9750,Paused'
            };

            const instructions = `MARKETING DASHBOARD - DATA TEMPLATE
            
INSTRUCTIONS:
1. This file contains 4 data templates
2. Copy each section to a separate Excel sheet
3. Fill in your data (keep the column headers)
4. Save each sheet as CSV
5. Upload CSVs to the dashboard

---

TRAFFIC DATA (Save as: traffic.csv)
${templates.traffic}

---

TRAFFIC SOURCES (Save as: sources.csv)
${templates.sources}

---

CAMPAIGN PERFORMANCE (Save as: campaigns.csv)
${templates.campaigns}

---

ROI DATA (Save as: roi.csv)
${templates.roi}`;

            const blob = new Blob([instructions], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Marketing_Dashboard_Template.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize on load
        window.onload = function() {
            initCharts();
        };
    </script>
</body>
</html>